
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>McKinney Chapter 11 - Practice (Wednesday 11:45 AM, Section 4) &#8212; FINA 6333 for Spring 2023</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="McKinney Chapter 11 - Practice (Wednesday 2:45 PM, Section 2)" href="mckinney_11_practice_02.html" />
    <link rel="prev" title="McKinney Chapter 11 - Practice (Monday 2:45 PM, Section 3)" href="mckinney_11_practice_03.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/DMSB_100th_LogoMark_CMYK_Horiz.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">FINA 6333 for Spring 2023</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="_introduction.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures and Practice
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="mckinney_02_lecture.html">
   McKinney Chapter 2 - Python Language Basics, IPython, and Jupyter Notebooks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_02_practice.html">
     McKinney Chapter 2 - Practice (Blank)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_02_practice_03.html">
     McKinney Chapter 2 - Practice (Section 3, Monday 2:45 PM)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_02_practice_04.html">
     McKinney Chapter 2 - Practice (Section 4, Wednesday 11:45 AM)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_02_practice_02.html">
     McKinney Chapter 2 - Practice (Section 2, Wednesday 2:45 PM)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="mckinney_03_lecture.html">
   McKinney Chapter 3 - Built-In Data Structures, Functions, and Files
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_03_practice.html">
     McKinney Chapter 3 - Practice (Blank)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_03_practice_04.html">
     McKinney Chapter 3 - Practice (Section 4, Wednesday 11:45 AM)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_03_practice_02.html">
     McKinney Chapter 3 - Practice (Section 2, Wednesday 2:45 PM)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="mckinney_04_lecture.html">
   McKinney Chapter 4 - NumPy Basics: Arrays and Vectorized Computation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_04_practice.html">
     McKinney Chapter 4 - Practice (Blank)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_04_practice_03.html">
     McKinney Chapter 4 - Practice (Section 3, Monday 2:45 PM)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_04_practice_04.html">
     McKinney Chapter 4 - Practice (Section 4, Wednesday 11:45 AM)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_04_practice_02.html">
     McKinney Chapter 4 - Practice (Section 2, Wednesday 2:45 PM)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="mckinney_05_lecture.html">
   McKinney Chapter 5 - Getting Started with pandas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_05_practice.html">
     McKinney Chapter 5 - Practice (Blank)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_05_practice_03.html">
     McKinney Chapter 5 - Practice (Section 3, Monday 2:45 PM)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_05_practice_04.html">
     McKinney Chapter 5 - Practice (Section 4, Wednesday 11:45 AM)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_05_practice_02.html">
     McKinney Chapter 5 - Practice (Section 2, Wednesday 2:45 PM)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="herron_01_lecture.html">
   Herron Topic 1 - Web Data, Log and Simple Returns, and Portfolio Math
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="herron_01_practice.html">
     Herron Topic 1 - Practice (Blank)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="herron_01_practice_03.html">
     Herron Topic 1 - Practice (Section 3, Monday 2:45 PM)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="herron_01_practice_04.html">
     Herron Topic 1 - Practice (Section 4, Wednesday 11:45 AM)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="herron_01_practice_02.html">
     Herron Topic 1 - Practice (Section 2, Wednesday 2:45 PM)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="mckinney_08_lecture.html">
   McKinney Chapter 8 - Data Wrangling: Join, Combine, and Reshape
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_08_practice.html">
     McKinney Chapter 8 - Practice (Blank)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_08_practice_03.html">
     McKinney Chapter 8 - Practice (Monday 2:45 PM, Section 3)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_08_practice_04.html">
     McKinney Chapter 8 - Practice (Wednesday 11:45 AM, Section 4)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_08_practice_02.html">
     McKinney Chapter 8 - Practice (Wednesday 2:45 PM, Section 2)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="mckinney_10_lecture.html">
   McKinney Chapter 10 - Data Aggregation and Group Operations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_10_practice.html">
     McKinney Chapter 10 - Practice (Blank)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_10_practice_all.html">
     McKinney Chapter 10 - Practice (All Sections)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="mckinney_11_lecture.html">
   McKinney Chapter 11 - Time Series
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_11_practice.html">
     McKinney Chapter 11 - Practice (Blank)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_11_practice_03.html">
     McKinney Chapter 11 - Practice (Monday 2:45 PM, Section 3)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     McKinney Chapter 11 - Practice (Wednesday 11:45 AM, Section 4)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mckinney_11_practice_02.html">
     McKinney Chapter 11 - Practice (Wednesday 2:45 PM, Section 2)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="herron_02_lecture.html">
   Herron Topic 2 - Trading Strategies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="herron_02_practice.html">
     Herron Topic 2 - Practice (Blank)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="herron_02_practice_03.html">
     Herron Topic 2 - Practice (Monday 2:45 PM, Section 3)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="herron_02_practice_04.html">
     Herron Topic 2 - Practice (Monday 11:45 AM, Section 4)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="herron_02_practice_02.html">
     Herron Topic 2 - Practice (Wednesday 2:45 PM, Section 2)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="herron_03_lecture.html">
   Herron Topic 3 - Multifactor Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="herron_03_practice.html">
     Herron Topic 3 - Practice (Blank)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="herron_03_practice_03.html">
     Herron Topic 3 - Practice (Monday 2:45 PM, Section 3)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="herron_03_practice_04.html">
     Herron Topic 3 - Practice (Monday 11:45 AM, Section 4)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="herron_03_practice_02.html">
     Herron Topic 3 - Practice (Wednesday 2:45 PM, Section 2)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Quizzes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="quiz_01.html">
   Quiz 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quiz_02.html">
   Quiz 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quiz_03.html">
   Quiz 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quiz_04.html">
   Quiz 4
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Projects
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="project_01.html">
   Project 1
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/dmsb-fina-6333/2023-spring/main?urlpath=lab/tree/Notebooks/mckinney_11_practice_04.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/dmsb-fina-6333/2023-spring"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/dmsb-fina-6333/2023-spring/issues/new?title=Issue%20on%20page%20%2Fmckinney_11_practice_04.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/mckinney_11_practice_04.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#announcements">
   Announcements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#practice">
   Practice
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#which-are-larger-overnight-or-intraday-returns">
     Which are larger, overnight or intraday returns?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cumulative-returns-with-all-available-data">
       Cumulative returns with all available data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#total-returns-for-each-calendar-year">
       Total returns for each calendar year
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#total-returns-over-rolling-252-trading-day-windows">
       Total returns over rolling 252-trading-day windows
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#total-returns-over-rolling-12-months-windows-after-calculating-monthly-returns">
       Total returns over rolling 12-months windows after calculating monthly returns
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sharpe-ratios-for-each-calendar-year">
       Sharpe Ratios for each calendar year
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-rolling-betas">
     Calculate rolling betas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-rolling-sharpe-ratios">
     Calculate rolling Sharpe Ratios
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#does-more-frequent-rebalancing-increase-or-decrease-returns">
     Does more frequent rebalancing increase or decrease returns?
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>McKinney Chapter 11 - Practice (Wednesday 11:45 AM, Section 4)</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#announcements">
   Announcements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#practice">
   Practice
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#which-are-larger-overnight-or-intraday-returns">
     Which are larger, overnight or intraday returns?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cumulative-returns-with-all-available-data">
       Cumulative returns with all available data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#total-returns-for-each-calendar-year">
       Total returns for each calendar year
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#total-returns-over-rolling-252-trading-day-windows">
       Total returns over rolling 252-trading-day windows
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#total-returns-over-rolling-12-months-windows-after-calculating-monthly-returns">
       Total returns over rolling 12-months windows after calculating monthly returns
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sharpe-ratios-for-each-calendar-year">
       Sharpe Ratios for each calendar year
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-rolling-betas">
     Calculate rolling betas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-rolling-sharpe-ratios">
     Calculate rolling Sharpe Ratios
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#does-more-frequent-rebalancing-increase-or-decrease-returns">
     Does more frequent rebalancing increase or decrease returns?
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="mckinney-chapter-11-practice-wednesday-11-45-am-section-4">
<h1>McKinney Chapter 11 - Practice (Wednesday 11:45 AM, Section 4)<a class="headerlink" href="#mckinney-chapter-11-practice-wednesday-11-45-am-section-4" title="Permalink to this headline">#</a></h1>
<section id="announcements">
<h2>Announcements<a class="headerlink" href="#announcements" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Quiz 4 mean was <span class="math notranslate nohighlight">\(87\%\)</span></p></li>
<li><p>Team Project 1 and Teammates Review 1 are due at 11:59 PM on Friday</p></li>
</ul>
</section>
<section id="practice">
<h2>Practice<a class="headerlink" href="#practice" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
<span class="o">%</span><span class="k">precision</span> 4
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yfinance</span> <span class="k">as</span> <span class="nn">yf</span>
<span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="kn">import</span> <span class="nn">requests_cache</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">requests_cache</span><span class="o">.</span><span class="n">CachedSession</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="which-are-larger-overnight-or-intraday-returns">
<h3>Which are larger, overnight or intraday returns?<a class="headerlink" href="#which-are-larger-overnight-or-intraday-returns" title="Permalink to this headline">#</a></h3>
<p>Yahoo! Finance provides easy acces to high-quality open, high, low, close (OHLC) and adjusted close price data.
However, Yahoo! Finance does not provide overnight or instraday returns directly.
Therefore, we need to use math to decompose daily returns into overnight and intraday returns.</p>
<p>Daily returns are defined as (adjusted) closing price to (adjusted) closing price returns.
Therefore, daily returns consist of overnight returns compounded with the intraday returns from the next day <span class="math notranslate nohighlight">\((1 + R_{daily}) = (1 + R_{overnight}) \times (1 + R_{intraday})\)</span> which we can rearrange to calculate overnight returns as <span class="math notranslate nohighlight">\(\frac{1 + R_{daily}}{1 + R_{intraday}} - 1 = R_{overnight}\)</span>.</p>
<p>We can calculate daily and intraday returns from Yahoo! Finance data as <span class="math notranslate nohighlight">\(R_{daily} = \frac{Adj\ Close_{t} - Adj\ Close_{t-1}}{Adj\ Close_{t-1}}\)</span> and <span class="math notranslate nohighlight">\(R_{intraday} = \frac{Close - Open}{Open}\)</span>.</p>
<p>Compare the following for the SPY ETF:</p>
<ol class="simple">
<li><p>Cumulative returns with all available data</p></li>
<li><p>Total returns for each calendar year</p></li>
<li><p>Total returns over rolling 252-trading-day windows</p></li>
<li><p>Total returns over rolling 12-months windows after calculating monthly returns
. Sharpe Ratios for each calendar year</p></li>
</ol>
<section id="cumulative-returns-with-all-available-data">
<h4>Cumulative returns with all available data<a class="headerlink" href="#cumulative-returns-with-all-available-data" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spy</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">tickers</span><span class="o">=</span><span class="s1">&#39;SPY&#39;</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">returns</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">spy</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">Date</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>
        <span class="n">Total</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">(),</span>
        <span class="n">Intraday</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">Overnight</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;Intraday&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
    <span class="p">[[</span><span class="s1">&#39;Intraday&#39;</span><span class="p">,</span> <span class="s1">&#39;Overnight&#39;</span><span class="p">,</span> <span class="s1">&#39;Total&#39;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Return&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">returns</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Return</th>
      <th>Intraday</th>
      <th>Overnight</th>
      <th>Total</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1993-02-01</th>
      <td>0.0064</td>
      <td>0.0007</td>
      <td>0.0071</td>
    </tr>
    <tr>
      <th>1993-02-02</th>
      <td>0.0028</td>
      <td>-0.0007</td>
      <td>0.0021</td>
    </tr>
    <tr>
      <th>1993-02-03</th>
      <td>0.0091</td>
      <td>0.0014</td>
      <td>0.0106</td>
    </tr>
    <tr>
      <th>1993-02-04</th>
      <td>0.0007</td>
      <td>0.0035</td>
      <td>0.0042</td>
    </tr>
    <tr>
      <th>1993-02-05</th>
      <td>0.0000</td>
      <td>-0.0007</td>
      <td>-0.0007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">returns</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>Return</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intraday</th>
      <td>7583.0000</td>
      <td>0.0000</td>
      <td>0.0097</td>
      <td>-0.0899</td>
      <td>-0.0042</td>
      <td>0.0004</td>
      <td>0.0047</td>
      <td>0.0930</td>
    </tr>
    <tr>
      <th>Overnight</th>
      <td>7583.0000</td>
      <td>0.0004</td>
      <td>0.0068</td>
      <td>-0.1045</td>
      <td>-0.0021</td>
      <td>0.0006</td>
      <td>0.0032</td>
      <td>0.0613</td>
    </tr>
    <tr>
      <th>Total</th>
      <td>7583.0000</td>
      <td>0.0004</td>
      <td>0.0119</td>
      <td>-0.1094</td>
      <td>-0.0045</td>
      <td>0.0007</td>
      <td>0.0059</td>
      <td>0.1452</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">returns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cumulative Return (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Intraday and Overnight Return Decomposition</span><span class="se">\n</span><span class="s1">Cumulative Returns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/mckinney_11_practice_04_13_0.png" src="_images/mckinney_11_practice_04_13_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">totret</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="total-returns-for-each-calendar-year">
<h4>Total returns for each calendar year<a class="headerlink" href="#total-returns-for-each-calendar-year" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">returns_a</span> <span class="o">=</span> <span class="n">returns</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;period&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">totret</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can use an anonymous (lambda) function to calculate total returns, too.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span>
    <span class="n">returns</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;period&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">returns_a</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>We can use <code class="docutils literal notranslate"><span class="pre">counts_a</span></code> to remove years with too few observations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counts_a</span> <span class="o">=</span> <span class="n">returns</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;period&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">returns_a</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">counts_a</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">250</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Total Return (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Intraday and Overnight Return Decomposition</span><span class="se">\n</span><span class="s1">Calendar Year Total Returns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/mckinney_11_practice_04_21_0.png" src="_images/mckinney_11_practice_04_21_0.png" />
</div>
</div>
<hr class="docutils" />
<p>What is the difference between <em>cumulative</em> and <em>total</em> return?</p>
<ul class="simple">
<li><p>Total return is the return for the entire holding period, or one value for a range of dates</p></li>
<li><p>Cumulative returns is the total return at every single date in a range of dates</p></li>
</ul>
<p>Total Returns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">returns</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.281008863138098
</pre></div>
</div>
</div>
</div>
<p>Cumulative Returns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">returns</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
1993-02-01    0.0071
1993-02-02    0.0092
1993-02-03    0.0199
1993-02-04    0.0242
1993-02-05    0.0235
               ...  
2023-03-07   14.7929
2023-03-08   14.8187
2023-03-09   14.5269
2023-03-10   14.3028
2023-03-13   14.2810
Name: Total, Length: 7583, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="total-returns-over-rolling-252-trading-day-windows">
<h4>Total returns over rolling 252-trading-day windows<a class="headerlink" href="#total-returns-over-rolling-252-trading-day-windows" title="Permalink to this headline">#</a></h4>
<p>We can repeat the total return calculation for 252-trading-day rolling windows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">returns_r</span> <span class="o">=</span> <span class="n">returns</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">totret</span><span class="p">)</span>

<span class="n">returns_r</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Return</th>
      <th>Intraday</th>
      <th>Overnight</th>
      <th>Total</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1993-02-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1993-02-02</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1993-02-03</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1993-02-04</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1993-02-05</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">returns_r</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Total Return (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Intraday and Overnight Return Decomposition</span><span class="se">\n</span><span class="s1">252-Trading-Day Rolling Windows&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/mckinney_11_practice_04_31_0.png" src="_images/mckinney_11_practice_04_31_0.png" />
</div>
</div>
</section>
<section id="total-returns-over-rolling-12-months-windows-after-calculating-monthly-returns">
<h4>Total returns over rolling 12-months windows after calculating monthly returns<a class="headerlink" href="#total-returns-over-rolling-12-months-windows-after-calculating-monthly-returns" title="Permalink to this headline">#</a></h4>
<p>We can chain this operation!
Note the plot has the same general appearance, but is less noisy because we aggregate to monthly total returns first!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">returns_mr</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">returns</span>
    <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;period&#39;</span><span class="p">)</span> <span class="c1"># aggregate from daily to monthly</span>
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">totret</span><span class="p">)</span> <span class="c1"># ...calculate total returns</span>
    <span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="c1"># aggregate into 12-month rolling windows</span>
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">totret</span><span class="p">)</span> <span class="c1"># ...calculate total returns</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">returns_mr</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Total Return (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Intraday and Overnight Return Decomposition</span><span class="se">\n</span><span class="s1">12-Month Rolling Windows&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/mckinney_11_practice_04_35_0.png" src="_images/mckinney_11_practice_04_35_0.png" />
</div>
</div>
</section>
<section id="sharpe-ratios-for-each-calendar-year">
<h4>Sharpe Ratios for each calendar year<a class="headerlink" href="#sharpe-ratios-for-each-calendar-year" title="Permalink to this headline">#</a></h4>
<p>We need the risk-free rate <code class="docutils literal notranslate"><span class="pre">RF</span></code> from Ken Frenchs daily benchmark factors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ff</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pdr</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;F-F_Research_Data_Factors_daily&#39;</span><span class="p">,</span>
        <span class="n">data_source</span><span class="o">=</span><span class="s1">&#39;famafrench&#39;</span><span class="p">,</span>
        <span class="n">start</span><span class="o">=</span><span class="s1">&#39;1900&#39;</span><span class="p">,</span>
        <span class="n">session</span><span class="o">=</span><span class="n">session</span>
    <span class="p">)</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>I think this easiest (and fastest approach) is to:</p>
<ol class="simple">
<li><p>Calculate a data frame of excess returns</p></li>
<li><p>Use an anonymous (lambda) function</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">returns_excess</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">returns</span>
    <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ff</span><span class="p">[</span><span class="s1">&#39;RF&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># note axis=0 for column-wise subtraction</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sharpes_a</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">returns_excess</span>
    <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;period&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="p">)</span>

<span class="n">sharpes_a</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Return</th>
      <th>Intraday</th>
      <th>Overnight</th>
      <th>Total</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1993</th>
      <td>-0.9172</td>
      <td>2.8058</td>
      <td>0.7233</td>
    </tr>
    <tr>
      <th>1994</th>
      <td>-1.1871</td>
      <td>0.8819</td>
      <td>-0.2732</td>
    </tr>
    <tr>
      <th>1995</th>
      <td>2.5275</td>
      <td>0.4197</td>
      <td>3.1845</td>
    </tr>
    <tr>
      <th>1996</th>
      <td>-0.1691</td>
      <td>1.6658</td>
      <td>1.2247</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>-0.1781</td>
      <td>2.5565</td>
      <td>1.2796</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sharpes_a</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sharpe Ratio&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Intraday and Overnight Return Decomposition</span><span class="se">\n</span><span class="s1">Calendar Year Sharpe Ratios&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/mckinney_11_practice_04_42_0.png" src="_images/mckinney_11_practice_04_42_0.png" />
</div>
</div>
</section>
</section>
<section id="calculate-rolling-betas">
<h3>Calculate rolling betas<a class="headerlink" href="#calculate-rolling-betas" title="Permalink to this headline">#</a></h3>
<p>Calculate rolling capital asset pricing model (CAPM) betas for the MATANA stocks.</p>
<p>The CAPM says the risk premium on a stock depends on the risk-free rate, beta, and the risk premium on the market: <span class="math notranslate nohighlight">\(E(R_{stock}) = R_f + \beta_{stock} \times (E(R_{market}) - R_f)\)</span>.
We can calculate CAPM betas as: <span class="math notranslate nohighlight">\(\beta_{stock} = \frac{Cov(R_{stock} - R_f, R_{market} - R_f)}{Var(R_{market} - R_f)}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matana</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">tickers</span><span class="o">=</span><span class="s1">&#39;MSFT AAPL TSLA AMZN NVDA GOOG&#39;</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">Date</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
    <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Ticker&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">matana</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Ticker</th>
      <th>AAPL</th>
      <th>AMZN</th>
      <th>GOOG</th>
      <th>MSFT</th>
      <th>NVDA</th>
      <th>TSLA</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1980-12-12</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-12-15</th>
      <td>-0.0522</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-12-16</th>
      <td>-0.0734</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-12-17</th>
      <td>0.0248</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-12-18</th>
      <td>0.0290</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">beta</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="n">ff</span><span class="p">[</span><span class="s1">&#39;RF&#39;</span><span class="p">],</span> <span class="n">rm_rf</span><span class="o">=</span><span class="n">ff</span><span class="p">[</span><span class="s1">&#39;Mkt-RF&#39;</span><span class="p">]):</span>
    <span class="n">ri_rf</span> <span class="o">=</span> <span class="n">ri</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">rf</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ri_rf</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">rm_rf</span><span class="p">)</span> <span class="o">/</span> <span class="n">rm_rf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ri_rf</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>A few notes:</p>
<ol class="simple">
<li><p>Here the <code class="docutils literal notranslate"><span class="pre">beta()</span></code> function is too smart for the <code class="docutils literal notranslate"><span class="pre">.rolling()</span></code> method.
Our <code class="docutils literal notranslate"><span class="pre">beta()</span></code> function matches stock and market data, but may not use 252 trading days at the end of the sample.
For example, in February 2023, we can slice a 252-trading-day window from the <code class="docutils literal notranslate"><span class="pre">matana</span></code> data frame.
However, the <code class="docutils literal notranslate"><span class="pre">beta()</span></code> function does not use January and Februrary 2023 data because they are missing from the <code class="docutils literal notranslate"><span class="pre">ff</span></code> data frame.
The easiest fix is to slice the <code class="docutils literal notranslate"><span class="pre">matana</span></code> data frame to remove 2023 data before we apply the <code class="docutils literal notranslate"><span class="pre">.rolling()</span></code> method.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> method and <code class="docutils literal notranslate"><span class="pre">beta()</span></code> function are <em>very slow</em> because they slice inefficiently!
We will write fasterbut ugliercode below.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">betas_1</span> <span class="o">=</span> <span class="n">matana</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">&#39;2022&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">timed</span> <span class="n">exec</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>

<span class="nn">~\Anaconda3\envs\fina-6333\lib\site-packages\pandas\core\window\rolling.py</span> in <span class="ni">apply</span><span class="nt">(self, func, raw, engine, engine_kwargs, args, kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1841</span>         <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1842</span>     <span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1843</span>         <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1844</span>             <span class="n">func</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1845</span>             <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">,</span>

<span class="nn">~\Anaconda3\envs\fina-6333\lib\site-packages\pandas\core\window\rolling.py</span> in <span class="ni">apply</span><span class="nt">(self, func, raw, engine, engine_kwargs, args, kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1313</span>             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;engine must be either &#39;numba&#39; or &#39;cython&#39;&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1314</span> 
<span class="ne">-&gt; </span><span class="mi">1315</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1316</span>             <span class="n">apply_func</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1317</span>             <span class="n">numba_cache_key</span><span class="o">=</span><span class="n">numba_cache_key</span><span class="p">,</span>

<span class="nn">~\Anaconda3\envs\fina-6333\lib\site-packages\pandas\core\window\rolling.py</span> in <span class="ni">_apply</span><span class="nt">(self, func, name, numba_cache_key, numba_args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">588</span> 
<span class="g g-Whitespace">    </span><span class="mi">589</span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;single&quot;</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">590</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_blockwise</span><span class="p">(</span><span class="n">homogeneous_func</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">591</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">592</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_tablewise</span><span class="p">(</span><span class="n">homogeneous_func</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<span class="nn">~\Anaconda3\envs\fina-6333\lib\site-packages\pandas\core\window\rolling.py</span> in <span class="ni">_apply_blockwise</span><span class="nt">(self, homogeneous_func, name)</span>
<span class="g g-Whitespace">    </span><span class="mi">460</span>             <span class="c1"># GH#42736 operate column-wise instead of block-wise</span>
<span class="g g-Whitespace">    </span><span class="mi">461</span>             <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">462</span>                 <span class="n">res</span> <span class="o">=</span> <span class="n">hfunc</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span>             <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">NotImplementedError</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">464</span>                 <span class="k">pass</span>

<span class="nn">~\Anaconda3\envs\fina-6333\lib\site-packages\pandas\core\window\rolling.py</span> in <span class="ni">hfunc</span><span class="nt">(values)</span>
<span class="g g-Whitespace">    </span><span class="mi">450</span>         <span class="k">def</span> <span class="nf">hfunc</span><span class="p">(</span><span class="n">values</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ArrayLike</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">451</span>             <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prep_values</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">452</span>             <span class="k">return</span> <span class="n">homogeneous_func</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">453</span> 
<span class="g g-Whitespace">    </span><span class="mi">454</span>         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

<span class="nn">~\Anaconda3\envs\fina-6333\lib\site-packages\pandas\core\window\rolling.py</span> in <span class="ni">homogeneous_func</span><span class="nt">(values)</span>
<span class="g g-Whitespace">    </span><span class="mi">580</span> 
<span class="g g-Whitespace">    </span><span class="mi">581</span>             <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">582</span>                 <span class="n">result</span> <span class="o">=</span> <span class="n">calc</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">583</span> 
<span class="g g-Whitespace">    </span><span class="mi">584</span>             <span class="k">if</span> <span class="n">numba_cache_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">~\Anaconda3\envs\fina-6333\lib\site-packages\pandas\core\window\rolling.py</span> in <span class="ni">calc</span><span class="nt">(x)</span>
<span class="g g-Whitespace">    </span><span class="mi">577</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_check_window_bounds</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">578</span> 
<span class="ne">--&gt; </span><span class="mi">579</span>                 <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">min_periods</span><span class="p">,</span> <span class="o">*</span><span class="n">numba_args</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">580</span> 
<span class="g g-Whitespace">    </span><span class="mi">581</span>             <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>

<span class="nn">~\Anaconda3\envs\fina-6333\lib\site-packages\pandas\core\window\rolling.py</span> in <span class="ni">apply_func</span><span class="nt">(values, begin, end, min_periods, raw)</span>
<span class="g g-Whitespace">   </span><span class="mi">1340</span>                 <span class="c1"># GH 45912</span>
<span class="g g-Whitespace">   </span><span class="mi">1341</span>                 <span class="n">values</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_on</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1342</span>             <span class="k">return</span> <span class="n">window_func</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">min_periods</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1343</span> 
<span class="g g-Whitespace">   </span><span class="mi">1344</span>         <span class="k">return</span> <span class="n">apply_func</span>

<span class="nn">~\Anaconda3\envs\fina-6333\lib\site-packages\pandas\_libs\window\aggregations.pyx</span> in <span class="ni">pandas._libs.window.aggregations.roll_apply</span><span class="nt">()</span>

<span class="nn">~\AppData\Local\Temp\ipykernel_14380\3587675373.py</span> in <span class="ni">beta</span><span class="nt">(ri, rf, rm_rf)</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="k">def</span> <span class="nf">beta</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="n">ff</span><span class="p">[</span><span class="s1">&#39;RF&#39;</span><span class="p">],</span> <span class="n">rm_rf</span><span class="o">=</span><span class="n">ff</span><span class="p">[</span><span class="s1">&#39;Mkt-RF&#39;</span><span class="p">]):</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="n">ri_rf</span> <span class="o">=</span> <span class="n">ri</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">rf</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="ne">----&gt; </span><span class="mi">3</span>     <span class="k">return</span> <span class="n">ri_rf</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">rm_rf</span><span class="p">)</span> <span class="o">/</span> <span class="n">rm_rf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ri_rf</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>

<span class="nn">~\Anaconda3\envs\fina-6333\lib\site-packages\pandas\core\series.py</span> in <span class="ni">cov</span><span class="nt">(self, other, min_periods, ddof)</span>
<span class="g g-Whitespace">   </span><span class="mi">2606</span>         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2607</span>             <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="ne">-&gt; </span><span class="mi">2608</span>         <span class="k">return</span> <span class="n">nanops</span><span class="o">.</span><span class="n">nancov</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2609</span>             <span class="n">this</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="n">min_periods</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span>
<span class="g g-Whitespace">   </span><span class="mi">2610</span>         <span class="p">)</span>

<span class="nn">~\Anaconda3\envs\fina-6333\lib\site-packages\pandas\core\nanops.py</span> in <span class="ni">_f</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">91</span>             <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">92</span>                 <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">invalid</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">93</span>                     <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">94</span>             <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">95</span>                 <span class="c1"># we want to transform an object array</span>

<span class="nn">~\Anaconda3\envs\fina-6333\lib\site-packages\pandas\core\nanops.py</span> in <span class="ni">nancov</span><span class="nt">(a, b, min_periods, ddof)</span>
<span class="g g-Whitespace">   </span><span class="mi">1599</span>         <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="g g-Whitespace">   </span><span class="mi">1600</span> 
<span class="ne">-&gt; </span><span class="mi">1601</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1602</span> 
<span class="g g-Whitespace">   </span><span class="mi">1603</span> 

<span class="nn">&lt;__array_function__ internals&gt;</span> in <span class="ni">cov</span><span class="nt">(*args, **kwargs)</span>

<span class="nn">~\Anaconda3\envs\fina-6333\lib\site-packages\numpy\lib\function_base.py</span> in <span class="ni">cov</span><span class="nt">(m, y, rowvar, bias, ddof, fweights, aweights, dtype)</span>
<span class="g g-Whitespace">   </span><span class="mi">2539</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2540</span>         <span class="n">X_T</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="ne">-&gt; </span><span class="mi">2541</span>     <span class="n">c</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X_T</span><span class="o">.</span><span class="n">conj</span><span class="p">())</span>
<span class="g g-Whitespace">   </span><span class="mi">2542</span>     <span class="n">c</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">true_divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fact</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2543</span>     <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>

<span class="nn">&lt;__array_function__ internals&gt;</span> in <span class="ni">dot</span><span class="nt">(*args, **kwargs)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<p>Here is the fast solution, which uses the optimized <code class="docutils literal notranslate"><span class="pre">.cov()</span></code> and <code class="docutils literal notranslate"><span class="pre">.var()</span></code> to calculate the numerator and denominator for <span class="math notranslate nohighlight">\(\beta\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">cov_2</span> <span class="o">=</span> <span class="n">matana</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">&#39;2022&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ff</span><span class="p">[</span><span class="s1">&#39;RF&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">ff</span><span class="p">[</span><span class="s1">&#39;Mkt-RF&#39;</span><span class="p">])</span>
<span class="n">var_2</span> <span class="o">=</span> <span class="n">ff</span><span class="p">[</span><span class="s1">&#39;Mkt-RF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">betas_2</span> <span class="o">=</span> <span class="n">cov_2</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">var_2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wall time: 20.9 ms
</pre></div>
</div>
</div>
</div>
<p>These solutions are identical!
Even though <code class="docutils literal notranslate"><span class="pre">beta_2</span></code> is 1000 times faster than <code class="docutils literal notranslate"><span class="pre">beta_1</span></code>, you should use the approach that makes the most sense to you!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">betas_1</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">betas_2</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">betas_1</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Beta&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Betas from Daily Returns</span><span class="se">\n</span><span class="s1">252-Trading-Day Rolling Windows&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/mckinney_11_practice_04_53_0.png" src="_images/mckinney_11_practice_04_53_0.png" />
</div>
</div>
</section>
<section id="calculate-rolling-sharpe-ratios">
<h3>Calculate rolling Sharpe Ratios<a class="headerlink" href="#calculate-rolling-sharpe-ratios" title="Permalink to this headline">#</a></h3>
<p>Calculate rolling Sharpe Ratios for the MATANA stocks.</p>
<p>The Sharpe Ratio is often used to evaluate fund managers.
The Sharpe Ratio is <span class="math notranslate nohighlight">\(SR_i = \frac{\overline{R_i - R_f}}{\sigma}\)</span>, where <span class="math notranslate nohighlight">\(\overline{R_i-R_f}\)</span> is mean fund return relative to the risk-free rate over some period and <span class="math notranslate nohighlight">\(\sigma\)</span> is the standard deviation of <span class="math notranslate nohighlight">\(R_i-R_f\)</span> over the same period.
While the Sharpe Ratio is typically used for funds, we can apply it to a single stock to test our knowledge of the <code class="docutils literal notranslate"><span class="pre">.rolling()</span></code> method.
Calculate and plot the one-year rolling Sharpe Ratio for the MATANA stocks using all available daily data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sharpe</span><span class="p">(</span><span class="n">ri</span><span class="p">,</span> <span class="n">rf</span><span class="o">=</span><span class="n">ff</span><span class="p">[</span><span class="s1">&#39;RF&#39;</span><span class="p">],</span> <span class="n">ann_fac</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">252</span><span class="p">)):</span>
    <span class="n">ri_rf</span> <span class="o">=</span> <span class="n">ri</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">rf</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ann_fac</span> <span class="o">*</span> <span class="n">ri_rf</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">/</span> <span class="n">ri_rf</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>See the discussion in the beta exercise above about how we can end up with a result based on fewer than 252 trading days of data because the <code class="docutils literal notranslate"><span class="pre">sharpe()</span></code> function matches the <code class="docutils literal notranslate"><span class="pre">matana</span></code> and <code class="docutils literal notranslate"><span class="pre">ff</span></code> data frames <em>after</em> the <code class="docutils literal notranslate"><span class="pre">.rolling()</span></code> mehtod slices a 252 trading day window.
The simplest solution is the remove the 2023 data from the <code class="docutils literal notranslate"><span class="pre">matana</span></code> data frame before we apply the <code class="docutils literal notranslate"><span class="pre">.rolling()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">sharpes_1</span> <span class="o">=</span> <span class="n">matana</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">&#39;2022&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">sharpe</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wall time: 13 s
</pre></div>
</div>
</div>
</div>
<p>Here is the fast solution, which:</p>
<ol class="simple">
<li><p>Uses the <code class="docutils literal notranslate"><span class="pre">.sub()</span></code> method to calculate excess returns</p></li>
<li><p>Then uses the optimized <code class="docutils literal notranslate"><span class="pre">.mean()</span></code> and <code class="docutils literal notranslate"><span class="pre">.std()</span></code> methods to calculate the numerator and denominator for the Sharpe Ratios</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_2</span> <span class="o">=</span> <span class="n">matana</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">&#39;2022&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ff</span><span class="p">[</span><span class="s1">&#39;RF&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_2</span> <span class="o">=</span> <span class="n">matana</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">&#39;2022&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">ff</span><span class="p">[</span><span class="s1">&#39;RF&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">252</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">sharpes_2</span> <span class="o">=</span> <span class="n">mean_2</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">std_2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">252</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">sharpes_1</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">sharpes_2</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sharpes_1</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sharpe Ratio&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sharpe Ratios from Daily Returns</span><span class="se">\n</span><span class="s1">252-Trading-Day Rolling Windows&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/mckinney_11_practice_04_62_0.png" src="_images/mckinney_11_practice_04_62_0.png" />
</div>
</div>
</section>
<section id="does-more-frequent-rebalancing-increase-or-decrease-returns">
<h3>Does more frequent rebalancing increase or decrease returns?<a class="headerlink" href="#does-more-frequent-rebalancing-increase-or-decrease-returns" title="Permalink to this headline">#</a></h3>
<p>Compare decade-total returns for the following rebalancing frequencies:</p>
<ol class="simple">
<li><p>Daily rebalancing</p></li>
<li><p>Monthly rebalancing</p></li>
<li><p>Annual rebalancing</p></li>
<li><p>Decade rebalancing</p></li>
</ol>
<p>Use equally-weighted portfolios of industry-level daily returns from Frenchs website: <code class="docutils literal notranslate"><span class="pre">'17_Industry_Portfolios_daily'</span></code>.</p>
<p><em><strong>This exercise is a little early, and we will revisit later in the course!</strong></em></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="mckinney_11_practice_03.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">McKinney Chapter 11 - Practice (Monday 2:45 PM, Section 3)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="mckinney_11_practice_02.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">McKinney Chapter 11 - Practice (Wednesday 2:45 PM, Section 2)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Richard Herron<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>